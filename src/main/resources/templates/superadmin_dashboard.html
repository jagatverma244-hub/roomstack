<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

  <meta charset="UTF-8">
  <title>Super Admin Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <style>
    body {
      background-color: #f0f2f5;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    h2 {
      font-weight: 700;
      color: #343a40;
    }

    .container {
      background-color: #ffffff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.05);
    }

    .delete-schema-btn {
      background: linear-gradient(145deg, #e53935, #d32f2f);
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      font-weight: 600;
      transition: background 0.3s;
    }

    .delete-schema-btn:hover {
      background: linear-gradient(145deg, #c62828, #b71c1c);
    }

    .message-box {
      margin-top: 20px;
      font-weight: 500;
    }

    .table thead {
      background-color: #343a40;
      color: white;
    }

    .table td, .table th {
      vertical-align: middle;
    }

    select.form-select {
      min-width: 140px;
    }

    .btn-sm {
      padding: 6px 12px;
      font-weight: 600;
    }

    .text-muted {
      font-style: italic;
      color: #888 !important;
    }

    .table-responsive {
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.03);
    }
  </style>
</head>
<body>
<div class="container mt-5">
  <h2 class="mb-4 text-center">ðŸ‘‘ Super Admin Dashboard</h2>

  <!-- Flash Messages -->
  <div th:if="${message}" class="alert alert-success message-box" th:text="${message}"></div>
  <div th:if="${error}" class="alert alert-danger message-box" th:text="${error}"></div>
<!--  <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>-->
<!--  <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>-->


  <!-- Delete Entire Schema Button -->
  <form th:action="@{/superadmin/delete-schema}" method="post"
        onsubmit="return confirm('âš  Are you sure you want to delete all data? This cannot be undone!');">
    <div class="text-end">
      <button type="submit" class="delete-schema-btn mb-4">
        ðŸ—‘ Delete Entire Schema Data
      </button>
    </div>
  </form>

  <!-- Users Table -->
  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="text-center">
      <tr>
        <th>ID</th>
        <th>Username</th>
        <th>Role</th>
        <th>Change Role</th>
        <th>Action</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="user : ${users}" class="text-center">
        <td th:text="${user.id}"></td>
        <td th:text="${user.username}"></td>
        <td th:text="${user.role}"></td>

        <td>
          <form th:action="@{/superadmin/changerole/{id}(id=${user.id})}" method="post" class="d-flex justify-content-center">
            <select name="role" class="form-select w-auto me-2">
              <option value="ROLE_USER" th:selected="${user.role == 'ROLE_USER'}">USER</option>
              <option value="ROLE_ADMIN" th:selected="${user.role == 'ROLE_ADMIN'}">ADMIN</option>
              <option value="ROLE_SUPERADMIN" th:selected="${user.role == 'ROLE_SUPERADMIN'}">SUPERADMIN</option>
            </select>
            <button type="submit" class="btn btn-sm btn-primary">Change</button>
          </form>
        </td>

        <td>
          <form th:action="@{/superadmin/delete/{id}(id=${user.id})}" method="post"
                th:if="${user.role != 'ROLE_SUPERADMIN'}">
            <button type="submit" class="btn btn-sm btn-danger"
                    onclick="return confirm('Are you sure you want to delete this user?');">Delete</button>
          </form>
          <span th:if="${user.role == 'ROLE_SUPERADMIN'}" class="text-muted">Not Allowed</span>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

</body>
</html>
